(this.webpackJsonpumavoice=this.webpackJsonpumavoice||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){e.exports=n(28)},,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/listener-one.2c38ffbb.svg"},function(e,t,n){},function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/stop.6af5a914.svg"},function(e,t,n){e.exports=n.p+"static/media/microphone.28cb80de.svg"},function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),r=n(9),s=n.n(r),a=(n(18),n(19),n(7)),i=n(1),l=n.n(i),u=n(2),h=n(5),p=n(6),d=n(12),f=n(10);n(21),n(22);function m(e){return c.a.createElement("section",{className:"listener-area"},c.a.createElement("div",{className:"listener-wrapper"},c.a.createElement("img",{src:n(23),alt:"Listener Default Expression"}),e.speechListenerStatus?function(e){console.log(e.speechListenerStatus);var t=c.a.createElement("div",{className:"bubble"},c.a.createElement("p",null,"That's it!"),c.a.createElement("p",null,"Good job!"));return"correct"===e&&(t=c.a.createElement("div",{className:"bubble"},c.a.createElement("p",null,"Nice!"))),"incorrect"===e&&(t=c.a.createElement("div",{className:"bubble"},c.a.createElement("p",null,"Try again!"))),t}(e.speechListenerStatus):""))}n(24);function g(e){var t=e.sentenceInfo,n=e.results,o=e.setWordSelected,r=e.wordSelected;return c.a.createElement("section",{className:"sentence-area"},c.a.createElement("div",{className:"phonetic-area"},r.phoneticValue?c.a.createElement("span",null,r.phoneticValue):c.a.createElement("span",{className:"unselected"}," Tap the word for more info ")),c.a.createElement("div",{className:"sentence-to-speech"},t.map((function(e,t){return c.a.createElement("span",{key:t,className:r.word===e.word?"word selected":"word",onClick:function(){return o(e)}},e.word)}))),c.a.createElement("div",{className:"result-area"},n.map((function(e,t){return e.value?c.a.createElement("span",{key:n.length>2?e.key:t,className:"correct slide"}):c.a.createElement("span",{key:n.length>2?e.key:t,className:"incorrect slide"})}))))}n(25);function v(e){var t=e.record,o=e.stop,r=e.isRecording;return c.a.createElement("section",{className:"actions-area"},c.a.createElement("div",{className:"center-actions"},r?c.a.createElement("button",{className:"stop",onClick:o},c.a.createElement("img",{src:n(26),alt:"Stop recording"})):c.a.createElement("button",{className:"talk",onClick:t},c.a.createElement("img",{src:n(27),alt:"Start recording"}))))}var S=n(11),w=function(){function e(){Object(h.a)(this,e),this.recognition=void 0,this.forceStop=!1;var t=window.speechRecognition||window.webkitSpeechRecognition;t&&(this.recognition=new t,this.builder())}return Object(p.a)(e,[{key:"startSpeechToText",value:function(){var e=this;return new Promise((function(t,n){try{e.recognition.lang="en-US",e.recognition.interimResults=!1,e.recognition.maxAlternatives=1,e.recognition.continuous=!0,e.recognition.speechResult=[],e.recognition.start(),e.recognition.onaudiostart=function(e){t(!0)}}catch(o){console.log(o),n(!1)}}))}},{key:"stopSpeechToText",value:function(){this.forceStop=!0,this.recognition.abort()}},{key:"getSpeech",value:function(){var e=this;return new Promise((function(t){e.recognition.onresult=function(e){var n,o=e.results[e.results.length-1][0].transcript.toLowerCase(),c=e.results[e.results.length-1][0].confidence;(n=this.speechResult).push.apply(n,Object(S.a)(o.trim().split(" "))),console.log(this.speechResult),console.log("Confidence: "+c),t(this.speechResult.join(" ")),this.speechResult=[]}}))}},{key:"builder",value:function(){var e=this;this.recognition.onspeechend=function(){e.recognition.stop()},this.recognition.onerror=function(e){console.log("Error occurred in recognition:"),console.log(e)},this.recognition.onaudioend=function(e){console.log("SpeechRecognition.onaudioend")},this.recognition.onend=function(t){console.log("SpeechRecognition.onend"),e.forceStop?e.forceStop=!1:(e.startSpeechToText(),console.log("Starting again"))},this.recognition.onnomatch=function(e){console.log("SpeechRecognition.onnomatch")},this.recognition.onsoundstart=function(e){console.log("SpeechRecognition.onsoundstart")},this.recognition.onsoundend=function(e){console.log("SpeechRecognition.onsoundend")},this.recognition.onspeechstart=function(e){console.log("SpeechRecognition.onspeechstart")},this.recognition.onstart=function(e){console.log("SpeechRecognition.onstart")}}}]),e}(),b=function(e){var t;return null===(t=(new DOMParser).parseFromString(e,"text/html").querySelector(".IPA"))||void 0===t?void 0:t.textContent},E=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://en.wiktionary.org/api/rest_v1/page/html/"+t).then((function(e){return e.text()})).then((function(e){return b(e)})).then((function(e){return String(e)})).catch((function(e){return console.error(e),""}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var o,c;return Object(h.a)(this,n),(o=t.call(this,e)).sentenceText="Nice to meet you",o.startSpeech=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.state.speechToText,e.next=3,t.startSpeechToText();case 3:e.sent&&(!0,o.setState({isRecording:!0})),o.setResult();case 6:case"end":return e.stop()}}),e)}))),o.stopSpeech=function(){o.state.speechToText.stopSpeechToText();o.setState({isRecording:!1}),o.setResult()},o.setResult=Object(u.a)(l.a.mark((function e(){var t,n,c,r,s,i,u,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.state.speechToText,e.next=3,t.getSpeech();case 3:if(n=e.sent,console.log("Final Speech: %c"+n,"font-family:system-ui;font-size:1rem;font-weight:bold"),"Nice to meet you",c=n.toLowerCase()==="Nice to meet you".toLowerCase(),(r=o.state.result).push({value:c,key:String(Math.random())}),r.length>3&&(r.shift(),r.forEach((function(e){e.key=String(Math.random())}))),o.setState({result:r}),s=c?"correct":"incorrect",3===o.state.result.length){i=0,u=Object(a.a)(o.state.result);try{for(u.s();!(h=u.n()).done;)h.value.value&&i++}catch(l){u.e(l)}finally{u.f()}3===i&&(console.log("Done"),o.stopSpeech(),s="finalspeech")}o.setState({speechListenerStatus:s}),o.state.isRecording&&o.setResult();case 15:case"end":return e.stop()}}),e)}))),o.setSentenceInfo=Object(u.a)(l.a.mark((function e(){var t,n,c,r,s,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.sentenceText,n=t.split(" "),c=[],r=Object(a.a)(n),e.prev=4,r.s();case 6:if((s=r.n()).done){e.next=14;break}return i=s.value,e.next=10,E(i);case 10:u=e.sent,c.push({word:i,phoneticValue:u});case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:o.setState({sentenceInfo:c});case 23:case"end":return e.stop()}}),e,null,[[4,16,19,22]])}))),o.setWordSelected=function(e){e.word===o.state.wordSelected.word&&(e={word:"",phoneticValue:""}),o.setState({wordSelected:e})},c=new w,o.state={result:[],speechToText:c,isRecording:!1,sentenceInfo:[{word:"loading...",phoneticValue:""}],wordSelected:{word:"",phoneticValue:""},speechListenerStatus:""},o}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.setSentenceInfo()}},{key:"getSpeechBubbleinfo",value:function(){}},{key:"render",value:function(){return c.a.createElement("div",{className:"exercise-wrapper"},c.a.createElement(m,{speechListenerStatus:this.state.speechListenerStatus}),c.a.createElement(g,{sentenceInfo:this.state.sentenceInfo,results:this.state.result,setWordSelected:this.setWordSelected,wordSelected:this.state.wordSelected}),c.a.createElement(v,{record:this.startSpeech,stop:this.stopSpeech,isRecording:this.state.isRecording}))}}]),n}(c.a.Component);var k=function(){return c.a.createElement(x,{serverSpeechValidation:!1})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[13,1,2]]]);
//# sourceMappingURL=main.a8424e4b.chunk.js.map